{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "schema.json",
  "title": "FedRAMP Machine Readable Requirements Schema",
  "description": "This schema defines the structure for FedRAMP Machine Readable Requirements documents. It is currently in rapid development and may change frequently.",
  "type": "object",
  "required": ["info"],
  "properties": {
    "info": {
      "type": "object",
      "description": "Information about the document including version information, general purpose, and other meta data.",
      "required": ["name", "short_name", "current_release", "types", "releases", "front_matter"],
      "additionalProperties": false,
      "properties": {
        "name": { "type": "string",
          "description": "The name of the document or policy"
        },
        "short_name": { "type": "string", "pattern": "^[A-Z]{3}$",
          "description": "3 character abbreviation assigned to this document. Used as part of the key for included objects."
        },
        "current_release": {"type": "string", "pattern": "^\\d{2}\\.\\d{2}[A-Z](?:\\s?DRAFT)?$",
          "description": "The currently official release. May not always be the latest version."
        },
        "types": {
          "type": "array",
          "description": "The types of objects included in the document. See IDENTIFIERS.md for explanations.",
          "items": {"type": "string", "enum": ["FRR", "FRD", "FRA", "KSI", "FRB"]},
          "uniqueItems": true,
          "minItems": 1
        },
        "releases": {
          "type": "array",
          "description": "An array of both past and future releases of this document.",
          "items": {
            "type": "object",
            "description": "A specific release or release draft",
            "required": ["id", "published_date", "description", "effective", "public_comment"],
            "additionalProperties": false,
            "properties": {
              "id": {"type": "string", "pattern": "^\\d{2}\\.\\d{2}[A-Z](?:\\s?DRAFT)?$",
                "description": "Unique identifier for the release in the format ##.##A. 'draft' may be appended to denote future releases."
              },
              "published_date": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date",
                "description": "A valid date string indicating the date that the changes in this release were published, or null for draft releases"
              },
              "description": { "type": "string",
                "description": "Description of the release"
              },
              "public_comment": { "type": "boolean",
                "description": "Indicates if the release was made available for public comment."
              },
              "effective": {
                "type": "object",
                "description": "collection of objects that describe when the release will be effective for specific FedRAMP authorization paths.",
                "additionalProperties": false,
                "properties": {
                  "20x": { "$ref": "#/$defs/release_target",
                    "description": "When this release will be effective for CSPs using the 20x authorization program."
                  },
                  "Rev5": { "$ref": "#/$defs/release_target",
                    "description": "When this release will be effective for CSPs using the Rev5 authorization program." }
                }
              },
              "related_rfcs": {
                "type": "array",
                "description": "Requests for Comment related to this specific release.",
                "items": {
                  "type": "object",
                  "required": ["start_date", "end_date", "id", "url", "short_name", "full_name", "discussion_url"],
                  "additionalProperties": false,
                  "properties": {
                    "start_date": { "type": ["string", "null"], "format": "date",
                      "description": "Date the RFC was opened or null"
                    },
                    "end_date": { "type": ["string", "null"], "format": "date",
                      "description": "Date the RFC was closed or null"
                    },
                    "id": { "type": "string",
                      "description": "RFC unique ID. Usually a 4 digit number like 0015."
                    },
                    "url": { "type": "string", "format": "uri",
                      "description": "The URL for the RFC"
                    },
                    "discussion_url": { "type": "string", "format": "uri",
                      "description": "URL for the github feedback on he RFC."
                    },
                    "short_name": { "type": "string",
                      "description": "Abbreviation for the RFC"
                    },
                    "full_name": { "type": "string",
                      "description": "Full title of the RFC"
                    }
                  }
                }
              }
            }
          }
        },
        "front_matter": {
          "type": "object",
          "description": "Meta data about the document",
          "required": ["purpose"],
          "properties": {
            "authority": {
              "type": "array",
              "description": "An array for references to specific laws, OMB Memos, or other regulatory documentation defining the legal authority behind the documented standard",
              "items": {
                "type": "object",
                "description": "A specific reference to a law, OMB Memo, or other regulatory documentation defining one of the legal authorities behind the documented standard",
                "required": ["reference", "reference_url", "description"],
                "additionalProperties": false,
                "properties": {
                  "reference": {"type": "string",
                    "description": "The name of the referenced law, OMB Memo, or other regulatory documentation"
                  },
                  "reference_url": {"type": "string", "format": "uri",
                    "description": "Link to the law, OMB Memo, or other regulatory documentation"
                  },
                  "description": {"type": "string",
                    "description": "Relevent text from the law, OMB Memo, or other regulatory documentation"
                  },
                  "delegation": {"type": "string",
                    "description": "The role or organization to which the referenced authority is assigned."
                  },
                  "delegation_url": {"type": "string", "format": "uri",
                    "description": "Link to the role or organization to which the referenced authority is assigned."
                  }
                }
              }
            },
            "purpose": {"type": "string",
              "description": "The purpose of the document"
            },
            "expected_outcomes": {"type": "array",
              "description": "The expected outcomes of the document",
              "items": {"type": "string"}}
          }
        }
      }
    },
    "FRA": {
      "type": "object",
      "description": "FedRAMP Technical Assistance Documents. Each document is identified by a 3 character abbreviation.",
      "additionalProperties": false,
      "patternProperties": {"^[A-Z]{3}$": {"type": "object", "$ref": "#/$defs/assistance_document"}}
    },
    "FRD": {
      "type": "object",
      "description": "FedRAMP Definitions. Each document is identified by a 3 character abbreviation.",
      "patternProperties": {"^[A-Z]{3}$": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["id", "term", "definition"],
          "additionalProperties": false,
          "properties": {
            "id": {"type": "string", "pattern": "^FRD-[A-Z]{3}-\\d{2}$", "description": "FedRAMP definition ID in the format FRD-AAA-##"},
            "term": {"type": "string", "description": "Term being defined"},
            "alts": {"type": "array", "description": "Alternate terms (synonyms)", "items": {"type": "string"}}, "definition": {"type": "string", "description": "The meaning of the listed term and any synonyms"},
            "note": {"type": "string", "description": ""}, "reference": {"type": "string", "description": ""},
            "reference_url": {"type": "string", "format": "uri", "description": ""},
            "notes": {"type": "array", "description": "", "items": {"type": "string", "description": ""}}
          }
        }
      }}
    },
    "FRR": {
      "type": "object",
      "patternProperties": {
        "^[A-Z]{3}$": {
          "type": "object",
          "required": ["base"],
          "additionalProperties": false,
          "properties": {
            "base": {"$ref": "#/$defs/requirement_section",
              "description": "The base requirements section for the document."
            },
            "exceptions": {"$ref": "#/$defs/requirement_section",
              "description": "The exceptions requirements section for the document."
            },
            "routine_recurring": {"$ref": "#/$defs/requirement_section",
              "description": "The requirements for routine recurring changes."},
            "adaptive": {"$ref": "#/$defs/requirement_section",
              "description": "The requirements for adaptive changes."},
            "transformative": {"$ref": "#/$defs/requirement_section",
              "description": "The requirements for transformative changes."},
            "impact": {"$ref": "#/$defs/requirement_section",
              "description": "The impact requirements section for the document."},
            "application": {"$ref": "#/$defs/requirement_section",
              "description": "The application requirements section for the document."},
            "id": {"$ref": "#/$defs/requirement_section",
              "description": "The id requirements section for the document."},
            "access_control": {"$ref": "#/$defs/requirement_section",
              "description": "The access control requirements section for the document."},
            "trust_center": {"$ref": "#/$defs/requirement_section",
              "description": "The trust center requirements section for the document."},
            "apply": {"$ref": "#/$defs/requirement_section",
              "description": "The apply requirements section for the document."},
            "reporting": {"$ref": "#/$defs/requirement_section",
              "description": "The reporting requirements section for the document."},
            "timeframes": {"$ref": "#/$defs/requirement_section",
              "description": "The timeframe section for the document."},
            "timeframe-low": {"$ref": "#/$defs/requirement_section",
              "description": "The timeframe requirements for low vulnerabilities."},
            "timeframe-moderate": {"$ref": "#/$defs/requirement_section",
              "description": "The timeframe requirements for moderate vulnerabilities."},
            "timeframe-high": {"$ref": "#/$defs/requirement_section",
              "description": "The timeframe requirements for high vulnerabilities."},
            "agencies": {"$ref": "#/$defs/requirement_section",
              "description": "The agencies requirements section for the document."},
            "quarterly_reviews": {"$ref": "#/$defs/requirement_section",
              "description": "The quarterly reviews requirements section for the document."}
          }
        }
      }
    },
    "KSI": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^[A-Z]{3}$": {
          "type": "object",
          "description": "A collection of KSIs on a related topic",
          "required": ["id", "name", "theme", "indicators"],
          "additionalProperties": false,
          "properties": {
            "id": {"type": "string", "pattern": "^KSI-[A-Z]{3}$"},
            "name": {"type": "string"},
            "theme": {"type": "string"},
            "referenced_fr": {"type": "array", "items": {"type": "string"}},
            "indicators": {
              "type": "array",
              "description": "Key Security Indicator.",
              "items": {
                "type": "object",
                "required": ["id", "statement"],
                "additionalProperties": false,
                "properties": {
                  "id": {"type": "string", "pattern": "^KSI-[A-Z]{3}-\\d{2}$"},
                  "name": {"type": "string"},
                  "statement": {"type": "string"},
                  "controls": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["control_id", "title"],
                      "additionalProperties": false,
                      "properties": {"control_id": {"type": "string"}, "title": {"type": "string"}}
                    }
                  },
                  "impact": {
                    "type": "object",
                    "required": ["low", "moderate"],
                    "properties": {"low": {"type": "boolean"}, "moderate": {"type": "boolean"}, "high": {"type": "boolean"}}
                  },
                  "referenced_fr": {"type": "array", "items": {"type": "string"}},
                  "note": {"type": "string"},
                  "retired": {"type": "boolean"},
                  "reference_url": {"type": "string", "format": "uri"},
                  "reference": {"type": "string"}
                }
              }
            }
          }
        }
      }
    }
  },
  "$defs": {
    "assistance_example": {
      "type": "object",
      "required": ["id", "key_tests", "examples"],
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "key_tests": {"type": "array", "minItems": 1, "items": { "type": "string", "minLength": 1 }},
        "examples": {"type": "array", "minItems": 1, "items": { "type": "string", "minLength": 1 }},
        "referenced_fr": {"type": "array", "items": { "type": "string" }}
      }
    },
    "assistance_requirement": {
      "type": "object",
      "required": ["id", "statement", "impact"],
      "additionalProperties": false,
      "properties": {
        "id": {"type": "string", "pattern": "^FRA-[A-Z]{3}-(?:\\d{2}|[A-Z]{2})$"},
        "applies_to": { "type": "string" },
        "statement": { "type": "string" },
        "impact": {
          "type": "object",
          "required": ["low", "moderate"],
          "properties": {"low": { "type": "boolean" }, "moderate": { "type": "boolean" }, "high": { "type": "boolean" }}
        },
        "referenced_fr": {"type": "array", "items": { "type": "string" }},
        "examples": {"type": "array", "minItems": 1, "items": { "$ref": "#/$defs/assistance_example" }}
      }
    },
    "assistance_document": {
      "type": "object",
      "required": ["id", "purpose", "requirements"],
      "additionalProperties": false,
      "properties": {
        "id": {"type": "string", "pattern": "^FRA-[A-Z]{3}$"},
        "disclaimer": { "type": "string" },
        "purpose": { "type": "string" },
        "referenced_fr": {"type": "array", "items": { "type": "string" }},
        "requirements": {"type": "array", "minItems": 1, "items": { "$ref": "#/$defs/assistance_requirement" }}
      }
    },
    "release_target": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "timeline": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "pilot": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "start_date": {"type": "string"},
                "designator": {"type": "string"},
                "comment": {"type": "string"}
              }
            },
            "closed_beta": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "start_date": {"type": "string"},
                "designator": {"type": "string"},
                "comment": {"type": "string"}
              }
            },
            "wide_release": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "start_date": {"type": "string"},
                "designator": {"type": "string"},
                "comment": {"type": "string"}
              }
            }
          }
        },
        "specific_release": {"type": "string", "pattern": "^(20x|R5)\\.[A-Z]{3}\\.((P|B)\\d+|WR)\\.\\d{2}\\.\\d{2}[A-Z]$"},
        "comments": {"type": "array", "items": {"type": "string"}
        }
      }
    },
    "requirement_section": {
      "type": "object",
      "required": ["application", "requirements", "id"],
      "properties": {
        "application": {"type": "string"},
        "id": {"type": "string"},
        "requirements": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "statement", "affects", "primary_key_word", "impact"],
            "additionalProperties": false,
            "properties": {
              "id": {"type": "string", "pattern": "^FRR-[A-Z]{3}(?:-[A-Z]{2})*-\\d{2}$"},
              "name": {"type": "string"},
              "statement": {"type": "string"},
              "affects": {"type": "array", "items": {"type": "string", "enum": ["Providers", "Agencies", "All", "FedRAMP", "Assessors"]}},
              "primary_key_word": {"type": "string", "enum": ["MUST", "SHOULD", "MAY", "SHOULD NOT", "MUST NOT", "NONE"]},
              "referenced_fr": {"type": "array", "items": {"type": "string"}},
              "is_interim": {"type": "boolean"},
              "following_information": {"type": "array", "items": {"type": "string"}},
              "following_information_bullets": {"type": "array", "items": {"type": "string"}},
              "note": {"type": "string"},
              "notes": {"type": "array", "items": {"type": "string"}},
              "pain_timeframes": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "required": ["pain", "max_days_irv_lev", "max_days_nirv_lev", "max_days_nlev"],
                  "additionalProperties": false,
                  "properties": {
                    "pain": {"type": "integer", "minimum": 0},
                    "max_days_irv_lev": {"anyOf": [{"type": "integer", "minimum": 0}, {"type": "string"}]},
                    "max_days_nirv_lev": {"type": "integer", "minimum": 0},
                    "max_days_nlev": {"type": "integer", "minimum": 0}
                  }
                },
                "uniqueItems": true
              },
              "reference": {"type": "string"},
              "reference_url": {"type": "string", "format": "uri"},
              "applies_to": {"type": "string"},
              "impact": {
                "type": "object",
                "required": ["low", "moderate"],
                "additionalProperties": false,
                "properties": {"low": {"type": "boolean"}, "moderate": {"type": "boolean"}, "high": {"type": "boolean"}}
              },
              "examples": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "required": ["id", "key_tests", "examples"],
                  "additionalProperties": false,
                  "properties": {
                    "id": {"type": "string", "minLength": 1},
                    "key_tests": {"type": "array", "minItems": 1, "items": {"type": "string", "minLength": 1}},
                    "examples": {"type": "array", "minItems": 1, "items": {"type": "string", "minLength": 1}}
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

